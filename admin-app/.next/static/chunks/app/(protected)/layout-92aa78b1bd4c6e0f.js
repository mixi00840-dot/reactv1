(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[648],{95986:function(e,t,n){Promise.resolve().then(n.bind(n,57666))},57666:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var s=n(57437),r=n(27648),o=n(2265),a=n(64131),c=n(99376);let i=(0,n(59625).Ue)(e=>({items:[],unread:0,add:t=>e(e=>({items:[t,...e.items].slice(0,50),unread:e.unread+1})),clear:()=>e({unread:0})}));var l=n(35749),d=n(12381);function u(){let{unread:e,add:t,clear:n,items:r}=i();return(0,o.useEffect)(()=>{var e;(0,l.zp)();let n=e=>{t({id:e._id||"".concat(Date.now()),body:e.body||"New notification",title:e.title,createdAt:e.createdAt})};return null===(e=(0,l.hb)())||void 0===e||e.on("notification",n),()=>{var e;null===(e=(0,l.hb)())||void 0===e||e.off("notification",n)}},[t]),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.Z,{variant:"outline",size:"icon",onClick:n,"aria-label":"Notifications",children:"\uD83D\uDD14"}),e>0&&(0,s.jsx)("span",{className:"absolute -right-1 -top-1 inline-flex h-5 min-w-[1.25rem] items-center justify-center rounded-full bg-destructive px-1 text-xs text-destructive-foreground",children:e})]})}function h(){let[e,t]=(0,o.useState)(()=>document.documentElement.classList.contains("dark")?"dark":"light");return(0,o.useEffect)(()=>{let t=document.documentElement;"dark"===e?t.classList.add("dark"):t.classList.remove("dark"),localStorage.setItem("theme",e)},[e]),(0,o.useEffect)(()=>{let e=localStorage.getItem("theme");e&&t(e)},[]),(0,s.jsx)(d.Z,{variant:"outline",size:"icon",onClick:()=>t("dark"===e?"light":"dark"),"aria-label":"Toggle theme",children:"dark"===e?"\uD83C\uDF19":"☀️"})}function f(e){let{children:t}=e,n=(0,c.useRouter)(),[i,l]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{a.Z.get("token")?l(!0):n.replace("/login")},[n]),i)?(0,s.jsxs)("div",{className:"min-h-screen",children:[(0,s.jsx)("header",{"data-cy":"header",className:"border-b bg-card",children:(0,s.jsxs)("div",{className:"mx-auto flex max-w-7xl items-center justify-between px-4 py-3",children:[(0,s.jsx)("div",{className:"font-semibold",children:"Mixillo Admin"}),(0,s.jsxs)("nav",{className:"flex items-center gap-4 text-sm",children:[(0,s.jsx)(r.default,{"data-cy":"nav-dashboard",href:"/dashboard",className:"hover:underline",children:"Dashboard"}),(0,s.jsx)(r.default,{"data-cy":"nav-users",href:"/users",className:"hover:underline",children:"Users"}),(0,s.jsx)(r.default,{"data-cy":"nav-stores",href:"/stores",className:"hover:underline",children:"Stores"}),(0,s.jsx)(r.default,{"data-cy":"nav-products",href:"/products",className:"hover:underline",children:"Products"}),(0,s.jsx)(r.default,{"data-cy":"nav-orders",href:"/orders",className:"hover:underline",children:"Orders"}),(0,s.jsx)(r.default,{"data-cy":"nav-payments",href:"/payments",className:"hover:underline",children:"Payments"}),(0,s.jsx)(r.default,{"data-cy":"nav-wallets",href:"/wallets",className:"hover:underline",children:"Wallets"}),(0,s.jsx)(r.default,{"data-cy":"nav-coin-packages",href:"/coin-packages",className:"hover:underline",children:"Coin Packages"}),(0,s.jsx)(r.default,{"data-cy":"nav-levels",href:"/levels",className:"hover:underline",children:"Levels"}),(0,s.jsx)(r.default,{"data-cy":"nav-banners",href:"/banners",className:"hover:underline",children:"Banners"}),(0,s.jsx)(r.default,{"data-cy":"nav-content",href:"/content",className:"hover:underline",children:"Content"}),(0,s.jsx)(r.default,{"data-cy":"nav-comments",href:"/comments",className:"hover:underline",children:"Comments"}),(0,s.jsx)(r.default,{"data-cy":"nav-featured",href:"/featured",className:"hover:underline",children:"Featured"}),(0,s.jsx)(r.default,{"data-cy":"nav-tags",href:"/tags",className:"hover:underline",children:"Tags"}),(0,s.jsx)(r.default,{"data-cy":"nav-sounds",href:"/sounds",className:"hover:underline",children:"Sounds"}),(0,s.jsx)(r.default,{"data-cy":"nav-analytics",href:"/analytics",className:"hover:underline",children:"Analytics"}),(0,s.jsx)(r.default,{"data-cy":"nav-system",href:"/system",className:"hover:underline",children:"System"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u,{}),(0,s.jsx)(h,{})]})]})}),(0,s.jsx)("main",{className:"container py-6",children:t})]}):null}},12381:function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var s=n(57437),r=n(2265),o=n(93448);let a={default:"bg-primary text-primary-foreground hover:opacity-90",secondary:"bg-secondary text-secondary-foreground hover:opacity-90",destructive:"bg-destructive text-destructive-foreground hover:opacity-90",outline:"border bg-transparent hover:bg-muted",ghost:"bg-transparent hover:bg-muted"},c={sm:"h-8 px-3 text-sm",md:"h-9 px-4 text-sm",lg:"h-10 px-5",icon:"h-9 w-9 p-0"},i=r.forwardRef((e,t)=>{let{className:n,variant:r="default",size:i="md",...l}=e;return(0,s.jsx)("button",{ref:t,className:(0,o.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",a[r],c[i],n),...l})});i.displayName="Button",t.Z=i},23340:function(e,t,n){"use strict";n.d(t,{Am:function(){return u},pm:function(){return h}});var s=n(2265);let r=0,o=new Map,a=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),d({type:"REMOVE_TOAST",toastId:e})},5e3);o.set(e,t)},c=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:n}=t;return n?a(n):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===n||void 0===n?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},i=[],l={toasts:[]};function d(e){l=c(l,e),i.forEach(e=>{e(l)})}function u(e){let{...t}=e,n=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:n});return d({type:"ADD_TOAST",toast:{...t,id:n,open:!0,onOpenChange:e=>{e||s()}}}),{id:n,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:n}})}}function h(){let[e,t]=s.useState(l);return s.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},35749:function(e,t,n){"use strict";n.d(t,{At:function(){return i},hb:function(){return l},zp:function(){return d}});var s=n(68680),r=n(64131),o=n(23340);class a{connect(){var e;let t=r.Z.get("token");if(!t){console.warn("⚠️ No auth token found, skipping socket connection");return}return(null===(e=this.socket)||void 0===e?void 0:e.connected)?console.log("✅ Socket already connected"):(this.socket=(0,s.io)("http://localhost:5000",{auth:{token:t},transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:this.maxReconnectAttempts,withCredentials:!0}),this.setupEventListeners()),this.socket}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{var e,t;console.log("✅ Socket connected:",null===(e=this.socket)||void 0===e?void 0:e.id),this.reconnectAttempts=0,null===(t=this.socket)||void 0===t||t.emit("authenticate",r.Z.get("token"))}),this.socket.on("disconnect",e=>{if(console.log("\uD83D\uDD0C Socket disconnected:",e),"io server disconnect"===e){var t;null===(t=this.socket)||void 0===t||t.connect()}}),this.socket.on("connect_error",e=>{console.error("❌ Socket connection error:",e),this.reconnectAttempts++,this.reconnectAttempts>=this.maxReconnectAttempts&&(0,o.Am)({variant:"destructive",title:"Connection Failed",description:"Unable to connect to real-time updates"})}),this.socket.on("authenticated",()=>{console.log("✅ Socket authenticated")}),this.socket.on("auth_error",e=>{console.error("❌ Socket auth error:",e)}))}on(e,t){var n;if(!this.socket){console.warn("⚠️ Socket not connected");return}this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),null===(n=this.eventHandlers.get(e))||void 0===n||n.add(t),this.socket.on(e,function(){for(var e=arguments.length,n=Array(e),s=0;s<e;s++)n[s]=arguments[s];return t(...n)})}off(e,t){if(this.socket){if(t){var n;this.socket.off(e,t),null===(n=this.eventHandlers.get(e))||void 0===n||n.delete(t)}else this.socket.off(e),this.eventHandlers.delete(e)}}emit(e,t){if(!this.socket||!this.socket.connected){console.warn("⚠️ Socket not connected, cannot emit:",e);return}this.socket.emit(e,t)}joinRoom(e){this.emit("join:room",e)}leaveRoom(e){this.emit("leave:room",e)}disconnect(){this.socket&&(this.eventHandlers.forEach((e,t)=>{var n;null===(n=this.socket)||void 0===n||n.off(t)}),this.eventHandlers.clear(),this.socket.disconnect(),this.socket=null)}isConnected(){var e;return(null===(e=this.socket)||void 0===e?void 0:e.connected)||!1}getSocket(){return this.socket}constructor(){this.socket=null,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.eventHandlers=new Map}}let c=null,i=()=>(c||(c=new a),c);function l(){return i().getSocket()}function d(){return i().connect()}},93448:function(e,t,n){"use strict";n.d(t,{cn:function(){return o},p:function(){return a}});var s=n(61994),r=n(53335);function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,s.W)(t))}function a(e){if(!e)return"";let t=new Date(e);return new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(t)}}},function(e){e.O(0,[137,685,706,971,117,744],function(){return e(e.s=95986)}),_N_E=e.O()}]);