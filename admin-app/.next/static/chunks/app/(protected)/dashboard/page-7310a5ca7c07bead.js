(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4],{11969:function(e,t,n){Promise.resolve().then(n.bind(n,20305))},20305:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var s=n(57437),r=n(2265),o=n(79820),a=n(40282),i=n(70525),c=n(42488),l=n(95805),d=n(16275),u=n(95252),m=n(44794),h=n(49322),f=n(91436),v=n(5481),p=n(56940),g=n(97059),x=n(62994),y=n(77719),j=n(26662),N=n(77031),b=n(8437),w=n(69140),S=n(35749),k=n(59625),A=n(89134);(0,k.Ue)()((0,A.tJ)(e=>({user:null,setUser:t=>e({user:t}),clearUser:()=>e({user:null})}),{name:"admin-storage"}));let Z=(0,k.Ue)()(e=>({notifications:[],unreadCount:0,addNotification:t=>e(e=>({notifications:[{...t,id:Date.now().toString(),createdAt:new Date().toISOString()},...e.notifications],unreadCount:e.unreadCount+1})),markAsRead:t=>e(e=>({notifications:e.notifications.map(e=>e.id===t?{...e,read:!0}:e),unreadCount:Math.max(0,e.unreadCount-1)})),markAllAsRead:()=>e(e=>({notifications:e.notifications.map(e=>({...e,read:!0})),unreadCount:0})),clearNotifications:()=>e({notifications:[],unreadCount:0})}));function D(e){let{title:t,value:n,icon:r,trend:a,color:c="blue"}=e;return(0,s.jsx)(o.Zb,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:t}),(0,s.jsx)("h3",{className:"text-3xl font-bold mt-2",children:n}),a&&(0,s.jsxs)("p",{className:"text-sm mt-2 flex items-center gap-1 ".concat(a>0?"text-green-600":"text-red-600"),children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),a>0?"+":"",a,"% from last month"]})]}),(0,s.jsx)("div",{className:"".concat({blue:"bg-blue-500",green:"bg-green-500",yellow:"bg-yellow-500",purple:"bg-purple-500",red:"bg-red-500"}[c]," p-3 rounded-full text-white"),children:(0,s.jsx)(r,{className:"h-6 w-6"})})]})})}function T(e){let{activities:t}=e;return t&&0!==t.length?(0,s.jsxs)(o.Zb,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Recent Activities"}),(0,s.jsx)("div",{className:"space-y-4",children:t.slice(0,10).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start gap-3 pb-3 border-b last:border-b-0",children:[(0,s.jsx)(c.Z,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm",children:e.description||e.message}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(e.createdAt||e.timestamp).toLocaleString()})]})]},t))})]}):(0,s.jsxs)(o.Zb,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Recent Activities"}),(0,s.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No recent activities"})]})}function O(){var e,t,n,i,c;let{data:k,isLoading:A}=(0,a.f_)(),{data:O,isLoading:C}=(0,a.su)(),{data:L,isLoading:_}=(0,a.uy)(30),{data:E,isLoading:q}=(0,a.Av)("daily"),R=Z(e=>e.addNotification);return((0,r.useEffect)(()=>{let e=(0,S.At)();return e.connect(),e.on("user:new",e=>{R({type:"info",title:"New User",message:"".concat(e.username," just signed up!"),read:!1})}),e.on("order:new",e=>{R({type:"success",title:"New Order",message:"Order #".concat(e.orderId," received - $").concat(e.total),read:!1})}),e.on("report:new",e=>{R({type:"warning",title:"New Report",message:"New ".concat(e.type," report received"),read:!1})}),()=>{e.off("user:new"),e.off("order:new"),e.off("report:new")}},[R]),A)?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(w.O,{className:"h-8 w-48"}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(e=>(0,s.jsx)(w.O,{className:"h-32"},e))}),(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,s.jsx)(w.O,{className:"h-80"}),(0,s.jsx)(w.O,{className:"h-80"})]})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Dashboard"}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Last updated: ",new Date().toLocaleTimeString()]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsx)(D,{title:"Total Users",value:(null==k?void 0:null===(e=k.totalUsers)||void 0===e?void 0:e.toLocaleString())||"0",icon:l.Z,trend:(null==k?void 0:k.userGrowth)||0,color:"blue"}),(0,s.jsx)(D,{title:"Total Orders",value:(null==k?void 0:null===(t=k.totalOrders)||void 0===t?void 0:t.toLocaleString())||"0",icon:d.Z,trend:(null==k?void 0:k.orderGrowth)||0,color:"green"}),(0,s.jsx)(D,{title:"Revenue",value:"$".concat(((null==k?void 0:k.totalRevenue)||0).toLocaleString()),icon:u.Z,trend:(null==k?void 0:k.revenueGrowth)||0,color:"yellow"}),(0,s.jsx)(D,{title:"Products",value:(null==k?void 0:null===(n=k.totalProducts)||void 0===n?void 0:n.toLocaleString())||"0",icon:m.Z,color:"purple"})]}),((null==k?void 0:k.pendingOrders)||0)>0&&(0,s.jsx)(o.Zb,{className:"p-4 bg-yellow-50 border-yellow-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(h.Z,{className:"h-5 w-5 text-yellow-600"}),(0,s.jsxs)("p",{className:"text-sm font-medium",children:["You have ",null==k?void 0:k.pendingOrders," pending orders and ",(null==k?void 0:k.pendingReports)||0," unresolved reports"]})]})}),(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,s.jsxs)(o.Zb,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"User Growth (Last 30 Days)"}),_?(0,s.jsx)(w.O,{className:"h-64"}):(0,s.jsx)(f.h,{width:"100%",height:300,children:(0,s.jsxs)(v.T,{data:L||[],children:[(0,s.jsx)(p.q,{strokeDasharray:"3 3"}),(0,s.jsx)(g.K,{dataKey:"date"}),(0,s.jsx)(x.B,{}),(0,s.jsx)(y.u,{}),(0,s.jsx)(j.uN,{type:"monotone",dataKey:"count",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.3})]})})]}),(0,s.jsxs)(o.Zb,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Revenue (Last 7 Days)"}),q?(0,s.jsx)(w.O,{className:"h-64"}):(0,s.jsx)(f.h,{width:"100%",height:300,children:(0,s.jsxs)(N.v,{data:E||[],children:[(0,s.jsx)(p.q,{strokeDasharray:"3 3"}),(0,s.jsx)(g.K,{dataKey:"date"}),(0,s.jsx)(x.B,{}),(0,s.jsx)(y.u,{}),(0,s.jsx)(b.$,{dataKey:"amount",fill:"#10b981"})]})})]})]}),(0,s.jsx)(T,{activities:O}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)(o.Zb,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Active Content"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:(null==k?void 0:null===(i=k.activeContent)||void 0===i?void 0:i.toLocaleString())||"0"})]}),(0,s.jsxs)(o.Zb,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Active Stores"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:(null==k?void 0:null===(c=k.activeStores)||void 0===c?void 0:c.toLocaleString())||"0"})]}),(0,s.jsxs)(o.Zb,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Live Streams"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:(null==k?void 0:k.liveStreams)||"0"})]})]})]})}(0,k.Ue)()((0,A.tJ)(e=>({sidebarCollapsed:!1,toggleSidebar:()=>e(e=>({sidebarCollapsed:!e.sidebarCollapsed})),setSidebarCollapsed:t=>e({sidebarCollapsed:t})}),{name:"ui-storage"})),(0,k.Ue)(e=>({isConnected:!1,setConnected:t=>e({isConnected:t})}))},79820:function(e,t,n){"use strict";n.d(t,{Zb:function(){return o}});var s=n(57437);n(2265);var r=n(93448);function o(e){let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})}},69140:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var s=n(57437),r=n(93448);function o(e){let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",t),...n})}},40282:function(e,t,n){"use strict";n.d(t,{$Q:function(){return h},Av:function(){return d},MK:function(){return p},SV:function(){return g},TY:function(){return v},UV:function(){return u},W4:function(){return m},f_:function(){return i},r0:function(){return f},su:function(){return c},uy:function(){return l}});var s=n(11713),r=n(29827),o=n(21770),a=n(71837);function i(){return(0,s.a)({queryKey:["dashboard","stats"],queryFn:async()=>{let{data:e}=await a.Z.get("/admin/dashboard/stats");return e.data},refetchInterval:3e4})}function c(){return(0,s.a)({queryKey:["dashboard","activities"],queryFn:async()=>{let{data:e}=await a.Z.get("/admin/dashboard/activities");return e.data},refetchInterval:1e4})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;return(0,s.a)({queryKey:["dashboard","user-growth",e],queryFn:async()=>{let{data:t}=await a.Z.get("/admin/analytics/user-growth?days=".concat(e));return t.data}})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"daily";return(0,s.a)({queryKey:["dashboard","revenue",e],queryFn:async()=>{let{data:t}=await a.Z.get("/admin/analytics/revenue?period=".concat(e));return t.data}})}function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2?arguments[2]:void 0;return(0,s.a)({queryKey:["users",e,t,n],queryFn:async()=>{let s=new URLSearchParams({page:e.toString(),limit:t.toString(),...n}),{data:r}=await a.Z.get("/users?".concat(s));return r.data}})}function m(){let e=(0,r.NL)();return(0,o.D)({mutationFn:async e=>{let{id:t,reason:n}=e,{data:s}=await a.Z.post("/admin/users/".concat(t,"/ban"),{reason:n});return s},onSuccess:()=>{e.invalidateQueries({queryKey:["users"]})}})}function h(){let e=(0,r.NL)();return(0,o.D)({mutationFn:async e=>{let{data:t}=await a.Z.post("/admin/users/".concat(e,"/unban"));return t},onSuccess:()=>{e.invalidateQueries({queryKey:["users"]})}})}function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2?arguments[2]:void 0;return(0,s.a)({queryKey:["content",e,t,n],queryFn:async()=>{let s=new URLSearchParams({page:e.toString(),limit:t.toString(),...n}),{data:r}=await a.Z.get("/content?".concat(s));return r.data}})}function v(){let e=(0,r.NL)();return(0,o.D)({mutationFn:async e=>{let{data:t}=await a.Z.post("/admin/content/".concat(e,"/approve"));return t},onSuccess:()=>{e.invalidateQueries({queryKey:["content"]})}})}function p(){let e=(0,r.NL)();return(0,o.D)({mutationFn:async e=>{let{id:t,reason:n}=e,{data:s}=await a.Z.post("/admin/content/".concat(t,"/reject"),{reason:n});return s},onSuccess:()=>{e.invalidateQueries({queryKey:["content"]})}})}function g(){let e=(0,r.NL)();return(0,o.D)({mutationFn:async e=>{let{id:t,reason:n}=e,{data:s}=await a.Z.post("/admin/content/".concat(t,"/ban"),{reason:n});return s},onSuccess:()=>{e.invalidateQueries({queryKey:["content"]})}})}},23340:function(e,t,n){"use strict";n.d(t,{Am:function(){return u},pm:function(){return m}});var s=n(2265);let r=0,o=new Map,a=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),d({type:"REMOVE_TOAST",toastId:e})},5e3);o.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:n}=t;return n?a(n):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===n||void 0===n?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],l={toasts:[]};function d(e){l=i(l,e),c.forEach(e=>{e(l)})}function u(e){let{...t}=e,n=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:n});return d({type:"ADD_TOAST",toast:{...t,id:n,open:!0,onOpenChange:e=>{e||s()}}}),{id:n,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:n}})}}function m(){let[e,t]=s.useState(l);return s.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},71837:function(e,t,n){"use strict";var s=n(83464),r=n(64131),o=n(23340);let a="http://localhost:5000",i=s.Z.create({baseURL:"".concat(a,"/api"),timeout:3e4,headers:{"Content-Type":"application/json"},withCredentials:!0});i.interceptors.request.use(e=>{let t=r.Z.get("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>(console.error("❌ Request Error:",e),Promise.reject(e))),i.interceptors.response.use(e=>e,async e=>{var t,n,c,l,d,u;let m=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!m._retry){m._retry=!0;try{let e=r.Z.get("refreshToken");if(e){let{token:t}=(await s.Z.post("".concat(a,"/api/auth/refresh"),{refreshToken:e})).data.data;return r.Z.set("token",t),m.headers&&(m.headers.Authorization="Bearer ".concat(t)),i(m)}}catch(e){return r.Z.remove("token"),r.Z.remove("refreshToken"),r.Z.remove("user"),(0,o.Am)({variant:"destructive",title:"Session Expired",description:"Please login again."}),window.location.href="/login",Promise.reject(e)}}let h=(null===(c=e.response)||void 0===c?void 0:null===(n=c.data)||void 0===n?void 0:n.message)||(null===(d=e.response)||void 0===d?void 0:null===(l=d.data)||void 0===l?void 0:l.error)||e.message,f=null===(u=e.response)||void 0===u?void 0:u.status;return[401,404].includes(f||0)||(0,o.Am)({variant:"destructive",title:"Error ".concat(f||""),description:h}),Promise.reject(e)}),t.Z=i},35749:function(e,t,n){"use strict";n.d(t,{At:function(){return c},hb:function(){return l},zp:function(){return d}});var s=n(68680),r=n(64131),o=n(23340);class a{connect(){var e;let t=r.Z.get("token");if(!t){console.warn("⚠️ No auth token found, skipping socket connection");return}return(null===(e=this.socket)||void 0===e?void 0:e.connected)?console.log("✅ Socket already connected"):(this.socket=(0,s.io)("http://localhost:5000",{auth:{token:t},transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:this.maxReconnectAttempts,withCredentials:!0}),this.setupEventListeners()),this.socket}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{var e,t;console.log("✅ Socket connected:",null===(e=this.socket)||void 0===e?void 0:e.id),this.reconnectAttempts=0,null===(t=this.socket)||void 0===t||t.emit("authenticate",r.Z.get("token"))}),this.socket.on("disconnect",e=>{if(console.log("\uD83D\uDD0C Socket disconnected:",e),"io server disconnect"===e){var t;null===(t=this.socket)||void 0===t||t.connect()}}),this.socket.on("connect_error",e=>{console.error("❌ Socket connection error:",e),this.reconnectAttempts++,this.reconnectAttempts>=this.maxReconnectAttempts&&(0,o.Am)({variant:"destructive",title:"Connection Failed",description:"Unable to connect to real-time updates"})}),this.socket.on("authenticated",()=>{console.log("✅ Socket authenticated")}),this.socket.on("auth_error",e=>{console.error("❌ Socket auth error:",e)}))}on(e,t){var n;if(!this.socket){console.warn("⚠️ Socket not connected");return}this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),null===(n=this.eventHandlers.get(e))||void 0===n||n.add(t),this.socket.on(e,function(){for(var e=arguments.length,n=Array(e),s=0;s<e;s++)n[s]=arguments[s];return t(...n)})}off(e,t){if(this.socket){if(t){var n;this.socket.off(e,t),null===(n=this.eventHandlers.get(e))||void 0===n||n.delete(t)}else this.socket.off(e),this.eventHandlers.delete(e)}}emit(e,t){if(!this.socket||!this.socket.connected){console.warn("⚠️ Socket not connected, cannot emit:",e);return}this.socket.emit(e,t)}joinRoom(e){this.emit("join:room",e)}leaveRoom(e){this.emit("leave:room",e)}disconnect(){this.socket&&(this.eventHandlers.forEach((e,t)=>{var n;null===(n=this.socket)||void 0===n||n.off(t)}),this.eventHandlers.clear(),this.socket.disconnect(),this.socket=null)}isConnected(){var e;return(null===(e=this.socket)||void 0===e?void 0:e.connected)||!1}getSocket(){return this.socket}constructor(){this.socket=null,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.eventHandlers=new Map}}let i=null,c=()=>(i||(i=new a),i);function l(){return c().getSocket()}function d(){return c().connect()}},93448:function(e,t,n){"use strict";n.d(t,{cn:function(){return o},p:function(){return a}});var s=n(61994),r=n(53335);function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,s.W)(t))}function a(e){if(!e)return"";let t=new Date(e);return new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(t)}}},function(e){e.O(0,[137,825,705,985,685,177,971,117,744],function(){return e(e.s=11969)}),_N_E=e.O()}]);