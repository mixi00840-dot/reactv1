(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[163],{69500:function(e,t,a){Promise.resolve().then(a.bind(a,37204))},37204:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var n=a(57437),r=a(2265),s=a(71837),o=a(40831),c=a(64014);let d=[{accessorKey:"_id",header:"ID"},{id:"user",header:"User",accessorFn:e=>{var t,a;return null!==(a=null===(t=e.user)||void 0===t?void 0:t.username)&&void 0!==a?a:""}},{id:"content",header:"Content",accessorFn:e=>{var t,a,n;return null!==(n=null!==(a=null===(t=e.content)||void 0===t?void 0:t.caption)&&void 0!==a?a:e.contentId)&&void 0!==n?n:""}},{accessorKey:"text",header:"Text"},{accessorKey:"status",header:"Status"},{id:"createdAt",header:"Created",accessorFn:e=>e.createdAt?(0,c.WU)(new Date(e.createdAt),"yyyy-MM-dd HH:mm"):""},{id:"actions",header:"Actions",cell:e=>{let{row:t,table:a}=e,r=async e=>{try{var n,r;await s.Z.put("/api/admin/comments/".concat(t.original._id,"/status"),{status:e}),null===(r=a.options.meta)||void 0===r||null===(n=r.refresh)||void 0===n||n.call(r)}catch(e){console.error("Action failed:",e)}};return(0,n.jsxs)("div",{className:"flex gap-1",children:["approved"!==t.original.status&&(0,n.jsx)("button",{"data-cy":"action-approve",className:"rounded bg-green-600 px-2 py-1 text-xs text-white hover:bg-green-700",onClick:()=>r("approved"),children:"Approve"}),"rejected"!==t.original.status&&(0,n.jsx)("button",{"data-cy":"action-reject",className:"rounded bg-red-600 px-2 py-1 text-xs text-white hover:bg-red-700",onClick:()=>r("rejected"),children:"Reject"}),"spam"!==t.original.status&&(0,n.jsx)("button",{"data-cy":"action-spam",className:"rounded bg-orange-600 px-2 py-1 text-xs text-white hover:bg-orange-700",onClick:()=>r("spam"),children:"Spam"})]})}}];function i(){let[e,t]=(0,r.useState)([]),[a,c]=(0,r.useState)(1),[i,l]=(0,r.useState)(20),[u,p]=(0,r.useState)(0),[h,m]=(0,r.useState)(""),[v,x]=(0,r.useState)("");async function g(){var e,n;let r=new URLSearchParams({page:String(a),limit:String(i)});h&&r.set("status",h),v&&r.set("q",v);let o=(await s.Z.get("/api/admin/comments?".concat(r.toString()))).data,c=o.comments||o.data||o;t(c),p(null!==(n=null===(e=o.pagination)||void 0===e?void 0:e.total)&&void 0!==n?n:c.length)}return(0,r.useEffect)(()=>{g()},[a,i,h]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[(0,n.jsx)("h1",{"data-cy":"page-title",className:"mr-auto text-xl font-semibold",children:"Comments"}),(0,n.jsx)("input",{placeholder:"Search text...",className:"h-9 w-56 rounded-md border bg-transparent px-3",value:v,onChange:e=>x(e.target.value)}),(0,n.jsx)("button",{className:"h-9 rounded-md border px-3",onClick:()=>{c(1),g()},children:"Search"}),(0,n.jsxs)("select",{"data-cy":"filter-status",className:"h-9 rounded-md border bg-transparent px-2",value:h,onChange:e=>{m(e.target.value),c(1)},children:[(0,n.jsx)("option",{value:"",children:"All"}),(0,n.jsx)("option",{value:"approved",children:"Approved"}),(0,n.jsx)("option",{value:"pending",children:"Pending"}),(0,n.jsx)("option",{value:"rejected",children:"Rejected"}),(0,n.jsx)("option",{value:"spam",children:"Spam"})]})]}),(0,n.jsx)(o.w,{columns:d,data:e,pageInfo:{page:a,pageSize:i,total:u},onPageChange:c,onPageSizeChange:e=>{l(e),c(1)},onSearch:()=>{c(1),g()},meta:{refresh:g}})]})}}},function(e){e.O(0,[137,825,594,14,351,971,117,744],function(){return e(e.s=69500)}),_N_E=e.O()}]);